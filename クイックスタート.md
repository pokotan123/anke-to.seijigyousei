# クイックスタートガイド

## 最短でシステムを起動する方法

### 前提条件

以下のツールが必要です：
- Node.js 18以上
- Docker Desktop（推奨）またはPostgreSQL + Redis

### 1. 依存関係のインストール

```bash
# バックエンド
cd backend
npm install

# フロントエンド（別ターミナル）
cd frontend
npm install
```

### 2. データベースの起動

#### Docker Composeを使用する場合（推奨）

```bash
# プロジェクトルートで
docker compose up -d
```

#### 手動で起動する場合

1. PostgreSQLを起動
2. データベースを作成：
```sql
CREATE DATABASE survey_db;
CREATE USER survey_user WITH PASSWORD 'survey_password';
GRANT ALL PRIVILEGES ON DATABASE survey_db TO survey_user;
```
3. `database/init.sql`を実行
4. Redisを起動

### 3. 環境変数の設定

#### バックエンド（`backend/.env`）

```env
PORT=3001
NODE_ENV=development
DATABASE_URL=postgresql://survey_user:survey_password@localhost:5432/survey_db
REDIS_URL=redis://localhost:6379
JWT_SECRET=your-secret-key-change-in-production
JWT_EXPIRES_IN=24h
FRONTEND_URL=http://localhost:3000
SESSION_SECRET=your-session-secret-change-in-production
```

#### フロントエンド（`frontend/.env.local`）

```env
NEXT_PUBLIC_API_URL=http://localhost:3001
NEXT_PUBLIC_WS_URL=ws://localhost:3001
```

### 4. システムの起動

#### 方法1: 起動スクリプト（推奨）

```bash
./start.sh
```

#### 方法2: 手動で起動

**ターミナル1: バックエンド**
```bash
cd backend
npm run seed  # 初回のみ（サンプルデータ投入）
npm run dev
```

**ターミナル2: フロントエンド**
```bash
cd frontend
npm run dev
```

### 5. アクセス

- **フロントエンド**: http://localhost:3000
- **管理画面**: http://localhost:3000/admin/login
- **バックエンドAPI**: http://localhost:3001

### 6. ログイン

- **ユーザー名**: `admin`
- **パスワード**: `admin123`

### 7. サンプルアンケート

シードデータ実行後、以下のようなログが表示されます：
```
📋 Survey URL: http://localhost:3000/vote/{unique_token}
```

このURLにアクセスして投票画面を確認できます。

## トラブルシューティング

### エラー: "Cannot find module"

```bash
# バックエンド
cd backend
rm -rf node_modules package-lock.json
npm install

# フロントエンド
cd frontend
rm -rf node_modules package-lock.json
npm install
```

### エラー: "Database connection error"

1. PostgreSQLが起動しているか確認
2. `DATABASE_URL`が正しいか確認
3. データベースとユーザーが作成されているか確認

### エラー: "Redis connection error"

1. Redisが起動しているか確認
2. `REDIS_URL`が正しいか確認

### エラー: "Port already in use"

既に起動しているプロセスを停止：
```bash
# ポート3001を使用しているプロセスを確認
lsof -i :3001

# プロセスを停止
kill -9 <PID>
```

## 次のステップ

1. 管理画面にログイン
2. アンケートを作成
3. 質問・選択肢を追加
4. 投票URLをコピー
5. 投票画面で投票
6. 分析ダッシュボードで結果を確認

詳細は `起動ガイド.md` と `動作確認チェックリスト.md` を参照してください。

