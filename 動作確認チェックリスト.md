# 動作確認チェックリスト

## 起動前の確認

- [ ] Node.js 18以上がインストールされている
- [ ] PostgreSQLが起動している（またはDocker Composeで起動）
- [ ] Redisが起動している（またはDocker Composeで起動）
- [ ] バックエンドの`.env`ファイルが設定されている
- [ ] フロントエンドの`.env.local`ファイルが設定されている

## 起動手順

### 方法1: 起動スクリプトを使用（推奨）

```bash
./start.sh
```

### 方法2: 手動で起動

#### ターミナル1: バックエンド
```bash
cd backend
npm install
npm run seed  # 初回のみ
npm run dev
```

#### ターミナル2: フロントエンド
```bash
cd frontend
npm install
npm run dev
```

## 動作確認項目

### 1. バックエンドの確認

- [ ] ヘルスチェックが動作する
  ```bash
  curl http://localhost:3001/health
  ```
  期待されるレスポンス: `{"status":"ok","timestamp":"..."}`

- [ ] データベース接続が成功している
  ログに `✅ Database connected` が表示される

- [ ] Redis接続が成功している
  ログに `✅ Redis connected` が表示される

### 2. フロントエンドの確認

- [ ] トップページが表示される
  URL: http://localhost:3000

- [ ] 管理画面ログイン画面が表示される
  URL: http://localhost:3000/admin/login

### 3. 認証機能の確認

- [ ] ログインが成功する
  - ユーザー名: `admin`
  - パスワード: `admin123`

- [ ] ログイン後にダッシュボードが表示される
  URL: http://localhost:3000/admin/dashboard

- [ ] ログアウトが動作する

### 4. アンケート管理機能の確認

- [ ] アンケート一覧が表示される

- [ ] 新規アンケートが作成できる
  - タイトル、説明、ステータス、期間を設定
  - 作成後、アンケート編集画面に遷移

- [ ] アンケートが編集できる
  - 基本情報の変更
  - 保存が成功する

- [ ] URLトークンが発行される
  - アンケート編集画面でURLが表示される
  - URLをコピーできる

- [ ] URLトークンが再発行できる
  - 再発行ボタンをクリック
  - 旧URLが無効化され、新URLが発行される

### 5. 質問・選択肢管理機能の確認

- [ ] 質問が追加できる
  - 「+ 質問を追加」ボタンをクリック
  - 質問文、タイプ、必須設定を入力
  - 保存が成功する

- [ ] 質問が編集できる
  - 質問の「編集」ボタンをクリック
  - 内容を変更して保存

- [ ] 質問が削除できる
  - 質問の「削除」ボタンをクリック
  - 確認ダイアログでOKを選択

- [ ] 質問の順序が変更できる
  - 「↑」「↓」ボタンで順序を変更
  - 順序が正しく反映される

- [ ] 選択肢が追加できる
  - 選択肢タイプの質問で「+ 追加」ボタンをクリック
  - 選択肢テキストを入力して保存

- [ ] 選択肢が編集・削除できる

- [ ] 選択肢の順序が変更できる

### 6. 投票機能の確認

- [ ] 投票画面が表示される
  - 発行されたURLにアクセス
  - アンケート情報、質問、選択肢が表示される

- [ ] 投票が送信できる
  - 選択肢を選択（またはテキストを入力）
  - 「投票する」ボタンをクリック
  - 投票完了メッセージが表示される

- [ ] 重複投票が防止される
  - 同じセッションで再度投票しようとするとエラー

- [ ] 必須質問のバリデーションが動作する
  - 必須質問を未回答で送信するとエラー

### 7. 分析ダッシュボードの確認

- [ ] リアルタイム集計が表示される
  URL: http://localhost:3000/admin/analytics

- [ ] グラフが表示される
  - 円グラフ
  - 棒グラフ
  - 時系列グラフ

- [ ] 自動更新が動作する
  - 自動更新をONに設定
  - 投票するとグラフが自動更新される

- [ ] Socket.io接続が確立される
  - ブラウザのコンソールで接続ログを確認

### 8. 高度な分析機能の確認

- [ ] クロス集計が動作する
  URL: http://localhost:3000/admin/analytics/advanced
  - 2つの質問を選択
  - 「分析実行」ボタンをクリック
  - クロス集計結果が表示される

- [ ] ヒートマップが動作する
  - 質問を選択
  - 「分析実行」ボタンをクリック
  - ヒートマップが表示される

### 9. 投票データ管理機能の確認

- [ ] 投票データ一覧が表示される
  URL: http://localhost:3000/admin/votes

- [ ] 検索が動作する
  - 検索ボックスにキーワードを入力
  - 該当する投票データが表示される

- [ ] フィルタリングが動作する
  - 質問でフィルター
  - 日付範囲でフィルター
  - フィルターリセットボタン

- [ ] ページネーションが動作する
  - 複数ページがある場合、ページ切り替えができる

- [ ] CSVエクスポートが動作する
  - 「CSV」ボタンをクリック
  - CSVファイルがダウンロードされる
  - フィルターが適用されたデータがエクスポートされる

- [ ] Excelエクスポートが動作する
  - 「Excel」ボタンをクリック
  - Excelファイルがダウンロードされる

### 10. パフォーマンス確認

- [ ] ページの読み込みが2秒以内
- [ ] 投票処理が1秒以内
- [ ] リアルタイム更新の遅延が1秒以内

## エラーが発生した場合

### よくあるエラーと対処法

1. **データベース接続エラー**
   - PostgreSQLが起動しているか確認
   - `DATABASE_URL`が正しいか確認

2. **Redis接続エラー**
   - Redisが起動しているか確認
   - `REDIS_URL`が正しいか確認

3. **モジュールが見つからない**
   - `npm install`を実行

4. **ポートが使用中**
   - 既存のプロセスを停止
   - またはポート番号を変更

## 動作確認完了後の次のステップ

1. サンプルアンケートで投票を複数回実行
2. 分析ダッシュボードでリアルタイム更新を確認
3. 投票データのエクスポートを確認
4. 高度な分析機能を試す

---

**確認日**: _____________
**確認者**: _____________
**結果**: [ ] 正常 [ ] 要修正

