# システム機能一覧

## 概要
本ドキュメントは、アンケート・投票システムの全機能を一覧化したものです。

---

## 1. 投票者向け機能

### 1.1 投票画面表示機能
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F-001 | 投票画面表示 | ユニークURLによるアンケート投票画面の表示 | 高 |
| F-002 | アンケート情報表示 | アンケートタイトル・説明文の表示 | 高 |
| F-003 | 質問・選択肢表示 | 質問文と選択肢の一覧表示 | 高 |
| F-004 | レスポンシブ対応 | PC・タブレット・スマートフォン対応 | 中 |

**詳細仕様**:
- URL形式: `/vote/{unique_token}`
- 認証不要でアクセス可能
- 公開期間外の場合はエラーメッセージを表示

---

### 1.2 投票実行機能
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F-005 | 投票送信 | 選択した回答の送信 | 高 |
| F-006 | 投票完了通知 | 投票完了メッセージの表示 | 高 |
| F-007 | 重複投票防止 | 同一セッション・同一質問への再投票を防止 | 高 |
| F-008 | 投票期間チェック | 公開期間外の投票を拒否 | 高 |
| F-009 | バリデーション | 必須質問の未回答チェック | 高 |

**詳細仕様**:
- 質問タイプ: 単一選択、複数選択、自由記述に対応
- セッションIDとsurvey_idの組み合わせで重複チェック
- サーバー側でのバリデーション実施

---

### 1.3 投票結果確認機能（オプション）
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F-010 | 結果表示 | 投票後の集計結果を表示 | 低 |
| F-011 | グラフ表示 | 管理者設定に応じたグラフ表示 | 低 |

**詳細仕様**:
- 管理者が許可した場合のみ表示
- リアルタイム集計結果の表示

---

## 2. 管理画面機能

### 2.1 認証機能
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F-101 | ログイン | ユーザー名・パスワードによる認証 | 高 |
| F-102 | ログアウト | セッション終了 | 高 |
| F-103 | セッション管理 | セッションの維持・管理 | 高 |
| F-104 | 権限管理 | 管理者権限（admin/viewer）の管理 | 中 |

**詳細仕様**:
- セッションタイムアウト: 30分（推奨）
- パスワードはハッシュ化して保存
- 最終ログイン日時の記録

---

### 2.2 質問管理機能
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F-201 | 質問作成 | 新規質問の作成 | 高 |
| F-202 | 質問編集 | 既存質問の編集 | 高 |
| F-203 | 質問削除 | 質問の削除 | 高 |
| F-204 | 質問文入力 | 質問文の入力・編集 | 高 |
| F-205 | 選択肢管理 | 選択肢の追加・編集・削除 | 高 |
| F-206 | 質問タイプ設定 | 単一選択/複数選択/自由記述の設定 | 高 |
| F-207 | 表示順序設定 | 質問の並び順の変更 | 中 |
| F-208 | 必須設定 | 質問の必須/任意の設定 | 高 |

**詳細仕様**:
- 質問タイプ:
  - `single_choice`: 単一選択（ラジオボタン）
  - `multiple_choice`: 複数選択（チェックボックス）
  - `text`: 自由記述（テキストエリア）
- 選択肢はドラッグ&ドロップで順序変更可能（推奨）

---

### 2.3 アンケート管理機能
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F-301 | アンケート作成 | 新規アンケートの作成 | 高 |
| F-302 | アンケート編集 | 既存アンケートの編集 | 高 |
| F-303 | アンケート削除 | アンケートの削除 | 高 |
| F-304 | タイトル・説明設定 | アンケートタイトル・説明文の設定 | 高 |
| F-305 | 質問紐付け | アンケートに質問を紐付け | 高 |
| F-306 | 公開期間設定 | 開始日時・終了日時の設定 | 高 |
| F-307 | 公開状態切替 | 公開/非公開の切り替え | 高 |
| F-308 | URL発行 | ユニークなURLトークンの自動生成 | 高 |
| F-309 | URL共有 | 発行されたURLのコピー・共有 | 高 |
| F-310 | URL再発行 | URLトークンの再発行（旧URL無効化） | 中 |
| F-311 | アンケート複製 | 既存アンケートの複製 | 中 |
| F-312 | アンケート一覧 | アンケート一覧の表示 | 高 |
| F-313 | 検索・フィルタ | アンケートの検索・フィルタリング | 中 |

**詳細仕様**:
- URLトークン: 8-12文字のランダム文字列（例: "abc123xyz"）
- ステータス: `draft`（下書き）、`published`（公開中）、`closed`（終了）
- 公開期間外でも管理者は編集可能

---

### 2.4 投票データ管理機能
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F-401 | 投票データ一覧 | 投票データの一覧表示 | 高 |
| F-402 | データエクスポート | CSV形式でのエクスポート | 高 |
| F-403 | Excelエクスポート | Excel形式でのエクスポート | 中 |
| F-404 | データ削除 | 投票データの削除 | 中 |
| F-405 | データ検索 | 投票データの検索 | 中 |
| F-406 | データフィルタ | アンケート・質問・期間でのフィルタリング | 中 |
| F-407 | ページネーション | 大量データのページ分割表示 | 中 |

**詳細仕様**:
- エクスポート形式: CSV（必須）、Excel（オプション）
- エクスポート項目: 投票ID、アンケート名、質問、回答、投票日時、IPアドレス等
- 削除時は確認ダイアログを表示

---

### 2.5 ダッシュボード閲覧機能
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F-501 | ダッシュボード遷移 | 管理画面からダッシュボードへの遷移 | 高 |
| F-502 | リアルタイム表示確認 | リアルタイム可視化の確認 | 高 |

---

## 3. ダッシュボード機能（BIツール）

### 3.1 リアルタイム可視化機能
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F-601 | リアルタイム更新 | WebSocket/SSEによるリアルタイム更新 | 高 |
| F-602 | 投票数カウント | リアルタイムでの投票数カウント | 高 |
| F-603 | グラフ自動更新 | グラフ・チャートの自動更新 | 高 |
| F-604 | 更新頻度設定 | 更新頻度の設定（1秒、5秒、10秒など） | 中 |

**詳細仕様**:
- 更新遅延: 1秒以内
- 通信方式: WebSocketまたはServer-Sent Events
- 更新頻度は管理者が設定可能

---

### 3.2 投票結果可視化機能
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F-701 | 円グラフ表示 | 選択肢別の投票数・割合を円グラフで表示 | 高 |
| F-702 | 棒グラフ表示 | 選択肢別の投票数を棒グラフで表示 | 高 |
| F-703 | 時系列グラフ | 時間帯別の投票推移を時系列グラフで表示 | 高 |
| F-704 | テーブル表示 | 詳細データをテーブル形式で表示 | 高 |
| F-705 | グラフ切替 | グラフタイプの切替 | 中 |

**詳細仕様**:
- グラフライブラリ: Chart.js / D3.js / Recharts
- グラフはインタラクティブ（ホバーで詳細表示等）
- データのドリルダウン対応（推奨）

---

### 3.3 投票者分析機能
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F-801 | 属性別集計 | IPアドレス・デバイス・地域別の集計 | 中 |
| F-802 | 投票パターン可視化 | 投票パターンの可視化 | 中 |
| F-803 | クロス集計 | 複数質問間の関連性分析 | 中 |
| F-804 | ヒートマップ | 時間帯×選択肢のヒートマップ表示 | 低 |

**詳細仕様**:
- 「誰がどこにどのくらい入れているか」の可視化
- 可能な範囲で投票者属性を分析
- クロス集計は2-3質問間の関連性を分析

---

### 3.4 ダッシュボード設定機能
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F-901 | アンケート選択 | 表示するアンケートの選択 | 高 |
| F-902 | 質問選択 | 表示する質問の選択 | 高 |
| F-903 | グラフタイプ選択 | 表示するグラフタイプの選択 | 中 |
| F-904 | 期間フィルタ | 期間でのフィルタリング | 中 |
| F-905 | ダッシュボード保存 | 設定したダッシュボードの保存 | 低 |
| F-906 | ダッシュボード共有 | 保存したダッシュボードの共有 | 低 |

**詳細仕様**:
- 複数アンケート・質問を同時に表示可能
- 設定はブラウザのローカルストレージに保存（推奨）

---

### 3.5 レポート機能
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F-1001 | レポート生成 | 分析レポートの自動生成 | 中 |
| F-1002 | PDFエクスポート | PDF形式でのレポートエクスポート | 中 |
| F-1003 | Excelエクスポート | Excel形式でのレポートエクスポート | 中 |
| F-1004 | 定期レポート | スケジュール実行による定期レポート | 低 |

**詳細仕様**:
- レポートには集計結果、グラフ、統計情報を含む
- 定期レポートはメール送信（オプション）

---

## 4. システム共通機能

### 4.1 エラーハンドリング
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F-1101 | エラー表示 | ユーザーフレンドリーなエラーメッセージ表示 | 高 |
| F-1102 | ログ記録 | エラーログの記録 | 高 |
| F-1103 | バリデーション | 入力値のバリデーション | 高 |

---

### 4.2 パフォーマンス最適化
| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F-1201 | キャッシュ機能 | Redisによるキャッシュ | 高 |
| F-1202 | ページネーション | 大量データのページ分割 | 中 |
| F-1203 | 遅延読み込み | 画像・データの遅延読み込み | 中 |

---

## 5. 機能一覧サマリー

### 機能数統計
- **投票者向け機能**: 11機能
- **管理画面機能**: 33機能
- **ダッシュボード機能**: 20機能
- **システム共通機能**: 5機能
- **合計**: 69機能

### 優先度別統計
- **高優先度**: 45機能（必須機能）
- **中優先度**: 20機能（推奨機能）
- **低優先度**: 4機能（オプション機能）

---

## 6. 機能実装フェーズ

### フェーズ1: 基本機能（高優先度）
- 認証機能
- アンケート・質問管理機能
- 投票機能
- 基本的なダッシュボード機能

### フェーズ2: 拡張機能（中優先度）
- 高度な分析機能
- レポート機能
- データエクスポート機能

### フェーズ3: オプション機能（低優先度）
- 投票結果公開機能
- 定期レポート機能
- ダッシュボード共有機能

---

## 7. 機能マトリックス

### ユーザー別機能マトリックス

| 機能カテゴリ | 投票者 | 管理者（viewer） | 管理者（admin） |
|-------------|--------|------------------|----------------|
| 投票画面表示 | ✓ | - | - |
| 投票実行 | ✓ | - | - |
| アンケート管理 | - | 閲覧のみ | ✓ |
| 質問管理 | - | 閲覧のみ | ✓ |
| 投票データ管理 | - | 閲覧のみ | ✓ |
| ダッシュボード | - | ✓ | ✓ |
| レポート生成 | - | ✓ | ✓ |

---

**作成日**: 2024年
**バージョン**: 1.0
**関連ドキュメント**: 要件定義書.md

